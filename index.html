<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connect Â· Prompt Library</title>
  <meta name="description" content="Repositorio interno de prompts para Connect. Encuentra y copia prompts en segundos." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DESIGN TOKENS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --brand: #FF6347;
      --brand-soft: #FF634720;
      --brand-hover: #E8553A;
      --bg-base: #FAFAF9;
      --bg-surface: #FFFFFF;
      --bg-surface-hover: #F5F5F4;
      --bg-elevated: #FFFFFF;
      --bg-inset: #F0EFED;
      --border: #E7E5E4;
      --border-subtle: #F0EFED;
      --text-primary: #1C1917;
      --text-secondary: #78716C;
      --text-tertiary: #A8A29E;
      --text-inverse: #FFFFFF;
      --shadow-sm: 0 1px 2px rgba(28,25,23,0.04);
      --shadow-md: 0 4px 12px rgba(28,25,23,0.06);
      --shadow-lg: 0 12px 40px rgba(28,25,23,0.10);
      --shadow-xl: 0 24px 60px rgba(28,25,23,0.14);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --font-body: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-mono: 'JetBrains Mono', 'SF Mono', monospace;
      --complexity-1: #10B981;
      --complexity-2: #3B82F6;
      --complexity-3: #F59E0B;
      --complexity-4: #EF4444;
      --toast-bg: #1C1917;
    }

    [data-theme="dark"] {
      --bg-base: #0C0A09;
      --bg-surface: #1C1917;
      --bg-surface-hover: #292524;
      --bg-elevated: #1C1917;
      --bg-inset: #0C0A09;
      --border: #292524;
      --border-subtle: #1C1917;
      --text-primary: #FAFAF9;
      --text-secondary: #A8A29E;
      --text-tertiary: #78716C;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.2);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
      --shadow-lg: 0 12px 40px rgba(0,0,0,0.4);
      --shadow-xl: 0 24px 60px rgba(0,0,0,0.5);
      --brand-soft: #FF634730;
      --toast-bg: #FAFAF9;
    }
    [data-theme="dark"] .toast { color: #1C1917; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESET & BASE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { font-size: 16px; scroll-behavior: smooth; }
    body {
      font-family: var(--font-body);
      background: var(--bg-base);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      transition: background 0.3s ease, color 0.3s ease;
    }
    button { cursor: pointer; font-family: inherit; }
    input, select, textarea { font-family: inherit; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOPBAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .topbar {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .topbar__inner {
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 1.25rem;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
    }
    .brand__logo {
      height: 28px;
      width: auto;
    }
    [data-theme="dark"] .brand__logo {
      filter: brightness(0) invert(1);
    }
    .brand__divider {
      width: 1px;
      height: 24px;
      background: var(--border);
    }
    .brand__meta { display: flex; flex-direction: column; }
    .brand__title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: 0.02em;
      line-height: 1.2;
    }
    .brand__sub {
      font-size: 0.65rem;
      color: var(--text-tertiary);
      letter-spacing: 0.04em;
      text-transform: uppercase;
      font-weight: 500;
    }
    .topbar__actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .iconbtn {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.5rem 0.75rem;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      font-size: 0.8125rem;
      font-weight: 500;
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    .iconbtn:hover {
      background: var(--bg-surface-hover);
      color: var(--text-primary);
      border-color: var(--text-tertiary);
    }
    .iconbtn.active {
      background: var(--brand-soft);
      border-color: var(--brand);
      color: var(--brand);
    }
    .hide-sm { display: inline; }
    @media (max-width: 640px) {
      .hide-sm { display: none; }
      .iconbtn { padding: 0.5rem; }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LANG TOGGLE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .langToggle {
      display: inline-flex;
      align-items: center;
      background: var(--bg-inset);
      border-radius: 100px;
      padding: 2px;
      gap: 0;
    }
    .langToggle__btn {
      padding: 0.3rem 0.625rem;
      border: none;
      background: transparent;
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-tertiary);
      transition: all 0.2s;
    }
    .langToggle__btn.active {
      background: var(--bg-surface);
      color: var(--text-primary);
      box-shadow: var(--shadow-sm);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HERO / SEARCH
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hero {
      max-width: 720px;
      margin: 0 auto;
      padding: 3rem 1.25rem 1.5rem;
      text-align: center;
    }
    .hero__title {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }
    .hero__title span {
      background: linear-gradient(135deg, var(--brand) 0%, #FF8A65 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .searchRow {
      position: relative;
      margin-bottom: 1rem;
    }
    .searchInput {
      width: 100%;
      padding: 0.875rem 1.25rem;
      padding-right: 3rem;
      background: var(--bg-surface);
      border: 1.5px solid var(--border);
      border-radius: var(--radius-lg);
      font-size: 0.9375rem;
      color: var(--text-primary);
      outline: none;
      transition: all 0.2s ease;
      box-shadow: var(--shadow-sm);
    }
    .searchInput::placeholder { color: var(--text-tertiary); }
    .searchInput:focus {
      border-color: var(--brand);
      box-shadow: 0 0 0 3px var(--brand-soft), var(--shadow-md);
    }
    .searchClear {
      position: absolute;
      right: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--text-tertiary);
      font-size: 1.25rem;
      padding: 0.25rem;
      display: none;
      transition: color 0.15s;
    }
    .searchClear:hover { color: var(--text-primary); }
    .searchClear.visible { display: block; }

    /* Chips */
    .chipRow {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
      margin-bottom: 1rem;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.4375rem 0.875rem;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 100px;
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--text-secondary);
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    .chip:hover {
      border-color: var(--brand);
      color: var(--brand);
      background: var(--brand-soft);
    }
    .chip.active {
      background: var(--brand);
      border-color: var(--brand);
      color: white;
    }
    .chip__icon { font-size: 1rem; line-height: 1; }

    /* Stats bar */
    .statsBar {
      display: flex;
      justify-content: center;
      gap: 2rem;
      padding: 0.75rem 0;
      margin-bottom: 0.5rem;
    }
    .stat { text-align: center; }
    .stat__num {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--brand);
      line-height: 1;
    }
    .stat__label {
      font-size: 0.6875rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 500;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FILTERS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .filtersWrap {
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 1.25rem;
    }
    .filters {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
    }
    .filters__left {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .filter { position: relative; }
    .filter > summary {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.4375rem 0.75rem;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      list-style: none;
      transition: all 0.15s;
      user-select: none;
    }
    .filter > summary::-webkit-details-marker { display: none; }
    .filter > summary::after { content: 'â–¾'; margin-left: 0.25rem; font-size: 0.7em; }
    .filter > summary:hover { border-color: var(--text-tertiary); color: var(--text-primary); }
    .filter[open] > summary { border-color: var(--brand); color: var(--brand); }
    .filter__panel {
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 0.5rem;
      min-width: 220px;
      max-height: 300px;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
      z-index: 50;
      animation: dropIn 0.15s ease;
    }
    @keyframes dropIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .filter__option {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4375rem 0.625rem;
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: background 0.1s;
    }
    .filter__option:hover { background: var(--bg-surface-hover); }
    .filter__option input { accent-color: var(--brand); margin: 0; }
    .filter__option.checked { color: var(--text-primary); font-weight: 500; }
    .filters__right { display: flex; align-items: center; gap: 0.5rem; }
    .select {
      padding: 0.4375rem 0.75rem;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      color: var(--text-secondary);
      outline: none;
      cursor: pointer;
    }
    .link {
      background: none;
      border: none;
      color: var(--brand);
      font-size: 0.8125rem;
      font-weight: 500;
      padding: 0.375rem 0.625rem;
      border-radius: var(--radius-sm);
      transition: background 0.15s;
    }
    .link:hover { background: var(--brand-soft); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       GRID
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .gridWrap {
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 1.25rem;
    }
    .gridHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 0 0.75rem;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.625rem;
      background: var(--bg-inset);
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--text-secondary);
    }
    .muted { font-size: 0.8125rem; color: var(--text-tertiary); }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 0.875rem;
      padding-bottom: 3rem;
    }
    @media (max-width: 640px) {
      .grid { grid-template-columns: 1fr; }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CARDS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .card {
      position: relative;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 1.25rem;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      flex-direction: column;
      gap: 0.625rem;
    }
    .card:hover {
      border-color: var(--text-tertiary);
      box-shadow: var(--shadow-md);
      transform: translateY(-1px);
    }
    .card__top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0.5rem;
    }
    .card__cat {
      font-size: 0.6875rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
      color: var(--brand);
      line-height: 1.3;
    }
    .card__complexity {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.125rem 0.5rem;
      border-radius: 100px;
      font-size: 0.6875rem;
      font-weight: 600;
      white-space: nowrap;
      flex-shrink: 0;
    }
    .card__complexity--1 { background: #10B98118; color: var(--complexity-1); }
    .card__complexity--2 { background: #3B82F618; color: var(--complexity-2); }
    .card__complexity--3 { background: #F59E0B18; color: var(--complexity-3); }
    .card__complexity--4 { background: #EF444418; color: var(--complexity-4); }
    .card__dot {
      width: 6px; height: 6px; border-radius: 50%; display: inline-block;
    }
    .card__dot--1 { background: var(--complexity-1); }
    .card__dot--2 { background: var(--complexity-2); }
    .card__dot--3 { background: var(--complexity-3); }
    .card__dot--4 { background: var(--complexity-4); }

    .card__title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.35;
    }
    .card__preview {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .card__bottom {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: auto;
      padding-top: 0.375rem;
    }
    .card__tags {
      display: flex;
      gap: 0.375rem;
      flex-wrap: wrap;
      flex: 1;
    }
    .card__tag {
      font-size: 0.6875rem;
      padding: 0.125rem 0.5rem;
      background: var(--bg-inset);
      border-radius: 100px;
      color: var(--text-tertiary);
      font-weight: 500;
    }
    .card__id {
      font-family: var(--font-mono);
      font-size: 0.65rem;
      color: var(--text-tertiary);
      flex-shrink: 0;
    }
    .card__fav {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: none;
      border: none;
      font-size: 1rem;
      opacity: 0;
      transition: opacity 0.15s;
      padding: 0.25rem;
      z-index: 2;
    }
    .card:hover .card__fav { opacity: 0.5; }
    .card__fav:hover { opacity: 1 !important; }
    .card__fav.is-fav { opacity: 1; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PROMPT DETAIL
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .page { display: block; }
    .page--hidden { display: none; }

    .promptTop {
      max-width: 1320px;
      margin: 0 auto;
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .promptLayout {
      max-width: 1320px;
      margin: 0 auto;
      padding: 0 1.25rem 3rem;
      display: grid;
      grid-template-columns: 1fr 280px;
      gap: 2rem;
      align-items: start;
    }
    @media (max-width: 900px) {
      .promptLayout { grid-template-columns: 1fr; }
    }
    .promptEditor {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .promptTitle {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }
    .promptMeta {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }
    .promptMeta__item {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.8125rem;
      color: var(--text-secondary);
    }
    .promptTextarea {
      width: 100%;
      min-height: 380px;
      padding: 1.25rem;
      background: var(--bg-inset);
      border: 1.5px solid var(--border);
      border-radius: var(--radius-md);
      font-family: var(--font-mono);
      font-size: 0.8125rem;
      line-height: 1.7;
      color: var(--text-primary);
      resize: vertical;
      outline: none;
      transition: border-color 0.2s;
    }
    .promptTextarea:focus { border-color: var(--brand); }
    .promptActions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.375rem;
      padding: 0.625rem 1.25rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-secondary);
      background: var(--bg-surface);
      transition: all 0.2s ease;
    }
    .btn:hover { border-color: var(--text-tertiary); color: var(--text-primary); }
    .btn--primary { background: var(--brand); border-color: var(--brand); color: white; }
    .btn--primary:hover { background: var(--brand-hover); border-color: var(--brand-hover); color: white; }

    /* Sidebar */
    .promptInfo {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      position: sticky;
      top: 80px;
    }
    .infoBlock {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .k {
      font-size: 0.6875rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
      color: var(--text-tertiary);
    }
    .v { font-size: 0.875rem; color: var(--text-secondary); }
    .vars { display: flex; flex-wrap: wrap; gap: 0.375rem; }
    .var-chip {
      display: inline-flex;
      padding: 0.25rem 0.625rem;
      background: var(--brand-soft);
      border: 1px solid var(--brand);
      border-radius: var(--radius-sm);
      font-family: var(--font-mono);
      font-size: 0.75rem;
      color: var(--brand);
      font-weight: 500;
    }
    .tags { display: flex; flex-wrap: wrap; gap: 0.375rem; }
    .tag-item {
      font-size: 0.75rem;
      padding: 0.1875rem 0.5rem;
      background: var(--bg-inset);
      border-radius: 100px;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    /* TCREI */
    .tcrei {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
    }
    .tcrei > summary {
      padding: 0.75rem 1rem;
      font-size: 0.8125rem;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      list-style: none;
      transition: background 0.15s;
    }
    .tcrei > summary::-webkit-details-marker { display: none; }
    .tcrei > summary::before { content: 'ğŸ“ '; }
    .tcrei > summary:hover { background: var(--bg-surface-hover); }
    .tcrei__body {
      padding: 0 1rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .tcrei__body div {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    .tcrei__body strong { color: var(--brand); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .toast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(120%);
      background: var(--toast-bg);
      color: var(--text-inverse);
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius-md);
      font-size: 0.875rem;
      font-weight: 500;
      box-shadow: var(--shadow-xl);
      z-index: 200;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      pointer-events: none;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EMPTY / FOOTER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .empty {
      text-align: center;
      padding: 4rem 1rem;
      color: var(--text-tertiary);
      grid-column: 1 / -1;
    }
    .empty__icon { font-size: 3rem; margin-bottom: 1rem; }
    .empty__title { font-size: 1.125rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem; }
    .empty__sub { font-size: 0.875rem; }

    .footerNote {
      text-align: center;
      padding: 1.5rem 0 2rem;
      font-size: 0.75rem;
      color: var(--text-tertiary);
    }
    .footerNote code {
      background: var(--bg-inset);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-family: var(--font-mono);
      font-size: 0.7rem;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-tertiary); }

    /* Animations */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .card { animation: fadeUp 0.3s ease both; }
    .card:nth-child(2) { animation-delay: 0.02s; }
    .card:nth-child(3) { animation-delay: 0.04s; }
    .card:nth-child(4) { animation-delay: 0.06s; }
    .card:nth-child(5) { animation-delay: 0.08s; }
    .card:nth-child(6) { animation-delay: 0.10s; }

    :focus-visible {
      outline: 2px solid var(--brand);
      outline-offset: 2px;
    }

    mark {
      background: var(--brand-soft);
      color: var(--brand);
      border-radius: 2px;
      padding: 0 2px;
    }
  </style>
</head>

<body>
  <!-- â•â•â•â•â•â• TOPBAR â•â•â•â•â•â• -->
  <header class="topbar">
    <div class="topbar__inner">
      <div class="brand" role="banner" aria-label="Connect Prompt Library">
        <img
          class="brand__logo"
          src="https://cdn.prod.website-files.com/64b580afe0544a5492bb37b7/64b580afe0544a5492bb389f_logo-completo.svg"
          alt="Connect"
        />
        <div class="brand__divider"></div>
        <div class="brand__meta">
          <div class="brand__title">Prompt Library</div>
          <div class="brand__sub">Herramientas de IA</div>
        </div>
      </div>

      <div class="topbar__actions">
        <div class="langToggle">
          <button class="langToggle__btn active" data-lang="es" type="button">ES</button>
          <button class="langToggle__btn" data-lang="en" type="button">EN</button>
        </div>
        <button class="iconbtn" id="btnFavorites" type="button" aria-label="Ver favoritos">
          â­ <span class="hide-sm">Favoritos</span>
        </button>
        <button class="iconbtn" id="btnTheme" type="button" aria-label="Cambiar tema">
          ğŸŒ™ <span class="hide-sm">Oscuro</span>
        </button>
      </div>
    </div>
  </header>

  <!-- â•â•â•â•â•â• LIST PAGE â•â•â•â•â•â• -->
  <main class="page" id="pageList">
    <section class="hero" aria-label="BÃºsqueda principal">
      <h1 class="hero__title">Â¿QuÃ© necesitas <span>hacer hoy</span>?</h1>

      <div class="searchRow">
        <input
          id="q"
          class="searchInput"
          type="search"
          placeholder="Buscar: correo, SOP, proveedor, seguridad, QA, Heliosâ€¦"
          autocomplete="off"
          autofocus
        />
        <button class="searchClear" id="btnClear" type="button" aria-label="Limpiar">âœ•</button>
      </div>

      <div class="chipRow" id="chipRow" aria-label="CategorÃ­as rÃ¡pidas"></div>

      <div class="statsBar">
        <div class="stat">
          <div class="stat__num" id="statTotal">â€”</div>
          <div class="stat__label">Prompts</div>
        </div>
        <div class="stat">
          <div class="stat__num" id="statCats">â€”</div>
          <div class="stat__label">CategorÃ­as</div>
        </div>
        <div class="stat">
          <div class="stat__num" id="statFavs">0</div>
          <div class="stat__label">Favoritos</div>
        </div>
      </div>
    </section>

    <div class="filtersWrap">
      <section class="filters" aria-label="Filtros">
        <div class="filters__left">
          <details class="filter" id="filterCatWrap">
            <summary>CategorÃ­a</summary>
            <div class="filter__panel" id="filterCategories"></div>
          </details>
          <details class="filter" id="filterTagWrap">
            <summary>Tags</summary>
            <div class="filter__panel" id="filterTags"></div>
          </details>
          <button class="link" id="btnResetFilters" type="button">Limpiar filtros</button>
        </div>
        <div class="filters__right">
          <select id="sort" class="select" aria-label="Ordenar">
            <option value="relevance">Relevancia</option>
            <option value="title_asc">TÃ­tulo Aâ†’Z</option>
            <option value="title_desc">TÃ­tulo Zâ†’A</option>
            <option value="id_asc">ID â†‘</option>
            <option value="id_desc">ID â†“</option>
          </select>
        </div>
      </section>
    </div>

    <section class="gridWrap" aria-label="Prompts">
      <div class="gridHeader">
        <div class="badge" id="badgeState">Todos los prompts</div>
        <div class="muted" id="countState">â€”</div>
      </div>
      <div class="grid" id="grid"></div>
      <div class="footerNote">
        Connect Prompt Library v2.0 Â· Framework T-C-R-E-I Â· <span id="footerCount">150</span> prompts
      </div>
    </section>
  </main>

  <!-- â•â•â•â•â•â• PROMPT DETAIL â•â•â•â•â•â• -->
  <main class="page page--hidden" id="pagePrompt" aria-label="Detalle de prompt">
    <header class="promptTop">
      <button class="link" id="btnBack" type="button">â† Volver a la librerÃ­a</button>
      <div style="display:flex;gap:0.5rem;align-items:center">
        <button class="iconbtn" id="btnFavToggle" type="button" aria-label="Favorito">â˜† <span class="hide-sm">Favorito</span></button>
      </div>
    </header>

    <section class="promptLayout">
      <section class="promptEditor" aria-label="Prompt editable">
        <div class="promptTitle" id="pTitle">â€”</div>
        <div class="promptMeta" id="pMeta"></div>
        <textarea class="promptTextarea" id="pText" spellcheck="false"></textarea>
        <div class="promptActions">
          <button class="btn btn--primary" id="btnCopy" type="button">ğŸ“‹ Copiar prompt</button>
          <button class="btn" id="btnReset" type="button">â†©ï¸ Restaurar original</button>
        </div>
      </section>

      <aside class="promptInfo" aria-label="InformaciÃ³n">
        <div class="infoBlock">
          <div class="k">ID</div>
          <div class="v" id="pId" style="font-family:var(--font-mono);font-size:0.8125rem">â€”</div>
        </div>
        <div class="infoBlock">
          <div class="k">Variables</div>
          <div class="vars" id="pVars"></div>
        </div>
        <div class="infoBlock">
          <div class="k">Tags</div>
          <div class="tags" id="pTags"></div>
        </div>
        <details class="tcrei">
          <summary>MetodologÃ­a TCREI</summary>
          <div class="tcrei__body">
            <div><strong>T â€” Tarea:</strong> quÃ© necesitas y para quÃ©.</div>
            <div><strong>C â€” Contexto:</strong> audiencia, paÃ­s, canal, limitaciones.</div>
            <div><strong>R â€” Reglas:</strong> formato, tono, criterios de calidad.</div>
            <div><strong>E â€” Ejemplo:</strong> opcional si el output es delicado.</div>
            <div><strong>I â€” Inputs:</strong> datos y variables.</div>
          </div>
        </details>
      </aside>
    </section>
  </main>

  <div class="toast" id="toast" aria-live="polite" aria-atomic="true"></div>

  <!-- â•â•â•â•â•â• APP â•â•â•â•â•â• -->
  <script>
  (function() {
    'use strict';

    // â”€â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const COMPLEXITY_LABELS = { 1: 'BÃ¡sico', 2: 'EstÃ¡ndar', 3: 'Intermedio', 4: 'Avanzado' };
    const CAT_ICONS = {
      'office': 'ğŸ“‹', 'comunicacion': 'âœ‰ï¸', 'reuniones': 'ğŸ—“ï¸',
      'proyectos': 'ğŸ“', 'datos': 'ğŸ“Š', 'it': 'ğŸ’»',
      'calidad': 'âœ…', 'operaciones_home': 'ğŸ ', 'operaciones_road': 'ğŸš—',
      'rrhh': 'ğŸ‘¥', 'finanzas': 'ğŸ’°', 'legal': 'âš–ï¸',
      'ciberseguridad': 'ğŸ”’', 'compras': 'ğŸ›’', 'marketing': 'ğŸ“£'
    };

    // â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let PROMPTS = [];
    let LANG = localStorage.getItem('cplib_lang') || 'es';
    let FAVORITES = JSON.parse(localStorage.getItem('cplib_favs') || '[]');
    let activeChipCat = null;
    let activeFilters = { categories: [], tags: [] };
    let currentPrompt = null;
    let originalPromptText = '';

    // â”€â”€â”€ DOM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const $ = s => document.querySelector(s);
    const $$ = s => document.querySelectorAll(s);
    const qInput = $('#q');
    const btnClear = $('#btnClear');
    const grid = $('#grid');
    const badgeState = $('#badgeState');
    const countState = $('#countState');
    const sortSelect = $('#sort');
    const pageList = $('#pageList');
    const pagePrompt = $('#pagePrompt');
    const toastEl = $('#toast');
    const chipRow = $('#chipRow');

    // â”€â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function t(obj) {
      if (!obj) return '';
      if (typeof obj === 'string') return obj;
      return obj[LANG] || obj['es'] || obj['en'] || '';
    }
    function catKey(p) { return p.category?.key || ''; }
    function catLabel(p) { return t(p.category); }
    function normalizeStr(s) {
      return (s || '').normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
    }

    // â”€â”€â”€ Theme â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const savedTheme = localStorage.getItem('cplib_theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    updateThemeBtn();

    $('#btnTheme').addEventListener('click', () => {
      const next = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem('cplib_theme', next);
      updateThemeBtn();
    });
    function updateThemeBtn() {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      $('#btnTheme').innerHTML = isDark ? 'â˜€ï¸ <span class="hide-sm">Claro</span>' : 'ğŸŒ™ <span class="hide-sm">Oscuro</span>';
    }

    // â”€â”€â”€ Language â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    $$('.langToggle__btn').forEach(btn => {
      btn.addEventListener('click', () => {
        LANG = btn.dataset.lang;
        localStorage.setItem('cplib_lang', LANG);
        $$('.langToggle__btn').forEach(b => b.classList.toggle('active', b.dataset.lang === LANG));
        rebuildUI();
      });
    });
    // Init active lang btn
    $$('.langToggle__btn').forEach(b => b.classList.toggle('active', b.dataset.lang === LANG));

    // â”€â”€â”€ Load Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function loadData() {
      grid.innerHTML = '<div class="empty"><div class="empty__icon">â³</div><div class="empty__title">Cargando promptsâ€¦</div></div>';
      try {
        const res = await fetch('./prompts.json');
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        // Support both flat array and { prompts: [...] } wrapper
        PROMPTS = Array.isArray(data) ? data : (data.prompts || []);
        rebuildUI();
      } catch (err) {
        grid.innerHTML = `
          <div class="empty">
            <div class="empty__icon">ğŸ“‚</div>
            <div class="empty__title">No se encontrÃ³ prompts.json</div>
            <div class="empty__sub">AsegÃºrate de que el archivo exista en la raÃ­z del repositorio.</div>
          </div>`;
        console.error('Error loading prompts.json:', err);
      }
    }

    function rebuildUI() {
      // Update hero text based on lang
      $('.hero__title').innerHTML = LANG === 'es'
        ? 'Â¿QuÃ© necesitas <span>hacer hoy</span>?'
        : 'What do you need to <span>do today</span>?';
      qInput.placeholder = LANG === 'es'
        ? 'Buscar: correo, SOP, proveedor, seguridad, QA, Heliosâ€¦'
        : 'Search: email, SOP, vendor, security, QA, Heliosâ€¦';

      // Stats
      const catSet = new Set(PROMPTS.map(catKey));
      $('#statTotal').textContent = PROMPTS.length;
      $('#statCats').textContent = catSet.size;
      $('#footerCount').textContent = PROMPTS.length;
      updateFavCount();

      // Build category chips
      const catEntries = [];
      const seenKeys = new Set();
      for (const p of PROMPTS) {
        const k = catKey(p);
        if (!seenKeys.has(k)) {
          seenKeys.add(k);
          catEntries.push({ key: k, label: catLabel(p) });
        }
      }
      const allLabel = LANG === 'es' ? 'Todos' : 'All';
      chipRow.innerHTML = `<button class="chip" data-cat="all" type="button"><span class="chip__icon">ğŸ“‹</span> ${allLabel}</button>` +
        catEntries.map(c => {
          const icon = CAT_ICONS[c.key] || 'ğŸ“';
          return `<button class="chip" data-cat="${c.key}" type="button"><span class="chip__icon">${icon}</span> ${c.label}</button>`;
        }).join('');

      // Re-bind chip events
      chipRow.querySelectorAll('.chip').forEach(chip => {
        chip.addEventListener('click', () => {
          const cat = chip.dataset.cat;
          chipRow.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
          if (activeChipCat === cat) {
            activeChipCat = null;
          } else {
            activeChipCat = cat;
            chip.classList.add('active');
          }
          render();
        });
      });

      // Build filter panels
      buildFilterPanel('filterCategories', catEntries.map(c => c.label), 'categories');
      const allTags = [...new Set(PROMPTS.flatMap(p => p.tags || []))].filter(t => t !== 'tcrei').sort();
      buildFilterPanel('filterTags', allTags, 'tags');

      render();
    }

    // â”€â”€â”€ Filters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function buildFilterPanel(containerId, items, filterKey) {
      const container = $(`#${containerId}`);
      container.innerHTML = items.map(item => `
        <label class="filter__option">
          <input type="checkbox" value="${item}" data-filter-key="${filterKey}">
          ${item}
        </label>
      `).join('');
      container.addEventListener('change', (e) => {
        const val = e.target.value;
        const key = e.target.dataset.filterKey;
        if (e.target.checked) {
          activeFilters[key].push(val);
        } else {
          activeFilters[key] = activeFilters[key].filter(v => v !== val);
        }
        e.target.closest('.filter__option').classList.toggle('checked', e.target.checked);
        render();
      });
    }

    // â”€â”€â”€ Search scoring â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function searchScore(prompt, query) {
      if (!query) return 1;
      const q = normalizeStr(query);
      const words = q.split(/\s+/).filter(Boolean);
      let score = 0;

      const title = normalizeStr(t(prompt.title));
      const cat = normalizeStr(catLabel(prompt));
      const catK = normalizeStr(catKey(prompt));
      const tags = (prompt.tags || []).map(normalizeStr);
      const text = normalizeStr(t(prompt.prompt));
      const vars = (prompt.variables || []).map(normalizeStr);
      const id = normalizeStr(prompt.id || '');

      for (const w of words) {
        if (id.includes(w)) score += 12;
        if (title.includes(w)) score += 10;
        if (title.startsWith(w)) score += 5;
        if (catK.includes(w) || cat.includes(w)) score += 6;
        if (tags.some(tg => tg.includes(w))) score += 8;
        if (vars.some(v => v.includes(w))) score += 4;
        if (text.includes(w)) score += 2;
      }
      if (title.includes(q)) score += 15;
      return score;
    }

    // â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function render() {
      const query = qInput.value.trim();
      let results = PROMPTS.map(p => ({ ...p, _score: searchScore(p, query) }));

      if (query) results = results.filter(p => p._score > 0);
      if (activeChipCat && activeChipCat !== 'all') {
        results = results.filter(p => catKey(p) === activeChipCat);
      }
      if (activeFilters.categories.length) {
        results = results.filter(p => activeFilters.categories.includes(catLabel(p)));
      }
      if (activeFilters.tags.length) {
        results = results.filter(p => (p.tags || []).some(tg => activeFilters.tags.includes(tg)));
      }

      const showFavs = $('#btnFavorites').classList.contains('active');
      if (showFavs) results = results.filter(p => FAVORITES.includes(p.id));

      // Sort
      const sv = sortSelect.value;
      if (sv === 'relevance' && query) {
        results.sort((a, b) => b._score - a._score);
      } else if (sv === 'title_asc') {
        results.sort((a, b) => t(a.title).localeCompare(t(b.title), LANG));
      } else if (sv === 'title_desc') {
        results.sort((a, b) => t(b.title).localeCompare(t(a.title), LANG));
      } else if (sv === 'id_asc') {
        results.sort((a, b) => (a.id || '').localeCompare(b.id || ''));
      } else if (sv === 'id_desc') {
        results.sort((a, b) => (b.id || '').localeCompare(a.id || ''));
      }

      // Badge
      const active = [];
      if (query) active.push(`"${query}"`);
      if (activeChipCat && activeChipCat !== 'all') {
        const lbl = PROMPTS.find(p => catKey(p) === activeChipCat);
        active.push(lbl ? catLabel(lbl) : activeChipCat);
      }
      if (activeFilters.categories.length) active.push(...activeFilters.categories);
      if (showFavs) active.push('â­ Favoritos');
      badgeState.textContent = active.length ? active.join(' Â· ') : (LANG === 'es' ? 'Todos los prompts' : 'All prompts');
      countState.textContent = `${results.length} / ${PROMPTS.length}`;

      if (results.length === 0) {
        grid.innerHTML = `
          <div class="empty">
            <div class="empty__icon">ğŸ”</div>
            <div class="empty__title">${LANG === 'es' ? 'Sin resultados' : 'No results'}</div>
            <div class="empty__sub">${LANG === 'es' ? 'Intenta con otros tÃ©rminos o limpia los filtros.' : 'Try different terms or clear filters.'}</div>
          </div>`;
        return;
      }

      grid.innerHTML = results.map(p => {
        const cx = p.complexity || 2;
        const cxLabel = COMPLEXITY_LABELS[cx] || 'EstÃ¡ndar';
        const isFav = FAVORITES.includes(p.id);
        const promptText = t(p.prompt) || '';
        const preview = promptText.replace(/\*\*/g, '').replace(/\n/g, ' ').substring(0, 100) + 'â€¦';
        const displayTags = (p.tags || []).filter(tg => tg !== 'tcrei').slice(0, 3);

        return `
        <article class="card" data-id="${p.id}" tabindex="0">
          <button class="card__fav ${isFav ? 'is-fav' : ''}" data-fav="${p.id}" aria-label="Favorito" onclick="event.stopPropagation()">
            ${isFav ? 'â­' : 'â˜†'}
          </button>
          <div class="card__top">
            <span class="card__cat">${catLabel(p)}</span>
            <span class="card__complexity card__complexity--${cx}">
              <span class="card__dot card__dot--${cx}"></span>
              ${cxLabel}
            </span>
          </div>
          <div class="card__title">${highlightMatch(t(p.title), query)}</div>
          <div class="card__preview">${preview}</div>
          <div class="card__bottom">
            <div class="card__tags">
              ${displayTags.map(tg => `<span class="card__tag">${tg}</span>`).join('')}
            </div>
            <span class="card__id">${p.id}</span>
          </div>
        </article>`;
      }).join('');

      // Events
      grid.querySelectorAll('.card').forEach(card => {
        card.addEventListener('click', () => openPrompt(card.dataset.id));
        card.addEventListener('keydown', e => { if (e.key === 'Enter') openPrompt(card.dataset.id); });
      });
      grid.querySelectorAll('[data-fav]').forEach(btn => {
        btn.addEventListener('click', () => toggleFav(btn.dataset.fav));
      });
    }

    function highlightMatch(text, query) {
      if (!query) return text;
      const q = normalizeStr(query);
      const idx = normalizeStr(text).indexOf(q);
      if (idx === -1) return text;
      return text.substring(0, idx) +
        '<mark>' + text.substring(idx, idx + query.length) + '</mark>' +
        text.substring(idx + query.length);
    }

    // â”€â”€â”€ Detail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openPrompt(id) {
      const p = PROMPTS.find(pr => pr.id === id);
      if (!p) return;
      currentPrompt = p;
      const promptText = t(p.prompt) || '';
      originalPromptText = promptText;

      pageList.classList.add('page--hidden');
      pagePrompt.classList.remove('page--hidden');
      window.scrollTo(0, 0);

      $('#pTitle').textContent = t(p.title);
      $('#pId').textContent = p.id;

      const cx = p.complexity || 2;
      const cxLabel = COMPLEXITY_LABELS[cx] || 'EstÃ¡ndar';
      $('#pMeta').innerHTML = `
        <span class="promptMeta__item">
          <span class="card__complexity card__complexity--${cx}"><span class="card__dot card__dot--${cx}"></span> ${cxLabel}</span>
        </span>
        <span class="promptMeta__item" style="color:var(--brand);font-weight:600">${catLabel(p)}</span>
      `;

      $('#pText').value = promptText;

      // Variables
      const vars = p.variables || [];
      $('#pVars').innerHTML = vars.length > 0
        ? vars.map(v => `<span class="var-chip">{{${v}}}</span>`).join('')
        : `<span class="muted">${LANG === 'es' ? 'Sin variables' : 'No variables'}</span>`;

      // Tags
      const displayTags = (p.tags || []).filter(tg => tg !== 'tcrei');
      $('#pTags').innerHTML = displayTags.map(tg => `<span class="tag-item">${tg}</span>`).join('');

      updateFavToggle(id);
      saveRecent(id);
    }

    function closePrompt() {
      pagePrompt.classList.add('page--hidden');
      pageList.classList.remove('page--hidden');
      currentPrompt = null;
    }

    // â”€â”€â”€ Favorites â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toggleFav(id) {
      const idx = FAVORITES.indexOf(id);
      if (idx > -1) {
        FAVORITES.splice(idx, 1);
        toast(LANG === 'es' ? 'Eliminado de favoritos' : 'Removed from favorites');
      } else {
        FAVORITES.push(id);
        toast(LANG === 'es' ? 'Guardado en favoritos â­' : 'Saved to favorites â­');
      }
      localStorage.setItem('cplib_favs', JSON.stringify(FAVORITES));
      updateFavCount();
      if (currentPrompt) updateFavToggle(id);
      render();
    }

    function updateFavToggle(id) {
      const isFav = FAVORITES.includes(id);
      const btn = $('#btnFavToggle');
      btn.innerHTML = isFav ? 'â­ <span class="hide-sm">Favorito</span>' : 'â˜† <span class="hide-sm">Favorito</span>';
      btn.classList.toggle('active', isFav);
    }

    function updateFavCount() {
      $('#statFavs').textContent = FAVORITES.length;
    }

    function saveRecent(id) {
      let recents = JSON.parse(localStorage.getItem('cplib_recents') || '[]');
      recents = recents.filter(r => r !== id);
      recents.unshift(id);
      localStorage.setItem('cplib_recents', JSON.stringify(recents.slice(0, 20)));
    }

    // â”€â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toast(msg) {
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastEl._t);
      toastEl._t = setTimeout(() => toastEl.classList.remove('show'), 2200);
    }

    // â”€â”€â”€ Copy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function copyPrompt() {
      const text = $('#pText').value;
      try {
        await navigator.clipboard.writeText(text);
        toast(LANG === 'es' ? 'Prompt copiado âœ“' : 'Prompt copied âœ“');
      } catch {
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.cssText = 'position:fixed;opacity:0';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        toast(LANG === 'es' ? 'Prompt copiado (fallback) âœ“' : 'Prompt copied (fallback) âœ“');
      }
    }

    // â”€â”€â”€ Events â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    qInput.addEventListener('input', () => {
      btnClear.classList.toggle('visible', qInput.value.length > 0);
      render();
    });
    btnClear.addEventListener('click', () => {
      qInput.value = '';
      btnClear.classList.remove('visible');
      qInput.focus();
      render();
    });

    sortSelect.addEventListener('change', render);

    $('#btnResetFilters').addEventListener('click', () => {
      activeFilters = { categories: [], tags: [] };
      activeChipCat = null;
      qInput.value = '';
      btnClear.classList.remove('visible');
      chipRow.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
      $$('.filter__option input').forEach(cb => { cb.checked = false; });
      $$('.filter__option').forEach(opt => opt.classList.remove('checked'));
      $$('.filter').forEach(d => d.removeAttribute('open'));
      render();
    });

    $('#btnFavorites').addEventListener('click', () => {
      $('#btnFavorites').classList.toggle('active');
      render();
    });

    $('#btnBack').addEventListener('click', closePrompt);
    $('#btnCopy').addEventListener('click', copyPrompt);
    $('#btnReset').addEventListener('click', () => {
      if (currentPrompt) {
        $('#pText').value = originalPromptText;
        toast(LANG === 'es' ? 'Prompt restaurado' : 'Prompt restored');
      }
    });
    $('#btnFavToggle').addEventListener('click', () => {
      if (currentPrompt) toggleFav(currentPrompt.id);
    });

    document.addEventListener('keydown', e => {
      if (e.key === 'Escape' && currentPrompt) closePrompt();
    });

    document.addEventListener('click', e => {
      $$('.filter').forEach(d => {
        if (!d.contains(e.target)) d.removeAttribute('open');
      });
    });

    // â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    loadData();
  })();
  </script>
</body>
</html>
