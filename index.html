<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connect · Prompt Library</title>
  <meta name="description" content="Repositorio interno de prompts para Connect Assistance." />
  <link rel="icon" type="image/png" href="./connect-logo.png" />
  <link rel="preconnect" href="https://api.fontshare.com">
  <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700,900&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    /* ═══════════════════════════════════════
       TOKENS
    ═══════════════════════════════════════ */
    :root {
      --brand: #E8553A;
      --brand-dim: #E8553A18;
      --brand-hover: #D14A32;
      --brand-text: #C4412B;

      --surface-0: #FBFBFA;
      --surface-1: #FFFFFF;
      --surface-2: #F6F5F3;
      --surface-3: #EEEDEB;

      --line: #E4E3E0;
      --line-strong: #D4D3D0;

      --ink-1: #171614;
      --ink-2: #5C5B57;
      --ink-3: #8D8C88;
      --ink-4: #B5B4B0;

      --mono: 'IBM Plex Mono', 'SF Mono', monospace;
      --sans: 'Satoshi', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;

      --r-xs: 6px;
      --r-sm: 8px;
      --r-md: 10px;
      --r-lg: 14px;

      --shadow-card: 0 1px 3px rgba(0,0,0,0.04), 0 0 0 1px rgba(0,0,0,0.03);
      --shadow-hover: 0 4px 16px rgba(0,0,0,0.07), 0 0 0 1px rgba(0,0,0,0.04);
      --shadow-dropdown: 0 8px 30px rgba(0,0,0,0.10), 0 0 0 1px rgba(0,0,0,0.04);
      --shadow-toast: 0 12px 40px rgba(0,0,0,0.18);

      --cx1: #1A8754; --cx2: #2563EB; --cx3: #D97706; --cx4: #DC2626;
    }

    [data-theme="dark"] {
      --surface-0: #111110;
      --surface-1: #1A1918;
      --surface-2: #222120;
      --surface-3: #2C2B29;
      --line: #2C2B29;
      --line-strong: #3D3C39;
      --ink-1: #F5F5F3;
      --ink-2: #A8A7A3;
      --ink-3: #7A7975;
      --ink-4: #555451;
      --brand-dim: #E8553A25;
      --shadow-card: 0 1px 3px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.04);
      --shadow-hover: 0 4px 16px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.06);
      --shadow-dropdown: 0 8px 30px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.06);
    }

    /* ═══════════════════════════════════════
       RESET
    ═══════════════════════════════════════ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { font-size: 15px; -webkit-text-size-adjust: 100%; scroll-behavior: smooth; }
    body {
      font-family: var(--sans);
      background: var(--surface-0);
      color: var(--ink-1);
      line-height: 1.55;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background .25s, color .25s;
    }
    body::before {
      content: '';
      position: fixed; inset: 0; z-index: -1;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.025'/%3E%3C/svg%3E");
      pointer-events: none;
    }
    button { cursor: pointer; font-family: inherit; }
    input, select, textarea { font-family: inherit; }
    :focus-visible { outline: 2px solid var(--brand); outline-offset: 2px; border-radius: 2px; }

    /* ═══════════════════════════════════════
       TOPBAR
    ═══════════════════════════════════════ */
    .topbar {
      position: sticky; top: 0; z-index: 100;
      height: 52px;
      background: var(--surface-1);
      border-bottom: 1px solid var(--line);
    }
    [data-theme="dark"] .topbar { background: var(--surface-0); }
    .topbar__inner {
      max-width: 1280px; margin: 0 auto; padding: 0 1.5rem;
      height: 100%; display: flex; align-items: center; justify-content: space-between;
    }
    .brand {
      display: flex; align-items: center; gap: 0.625rem;
      text-decoration: none; user-select: none;
    }
    .brand__logo { height: 22px; width: auto; }
    [data-theme="dark"] .brand__logo { filter: brightness(0) invert(1); }
    .brand__sep { width: 1px; height: 18px; background: var(--line-strong); }
    .brand__label {
      font-size: 0.8rem; font-weight: 700; color: var(--ink-2);
      letter-spacing: 0.04em; text-transform: uppercase;
    }

    .topbar__right { display: flex; align-items: center; gap: 0.375rem; }

    .tb {
      display: inline-flex; align-items: center; gap: 0.3rem;
      padding: 0.375rem 0.625rem;
      background: transparent; border: 1px solid transparent;
      border-radius: var(--r-sm); font-size: 0.8rem; font-weight: 500;
      color: var(--ink-3); transition: all .15s; white-space: nowrap;
    }
    .tb:hover { color: var(--ink-1); background: var(--surface-2); }
    .tb.on { color: var(--brand-text); background: var(--brand-dim); border-color: var(--brand-text); }
    .tb svg { width: 15px; height: 15px; stroke: currentColor; fill: none; stroke-width: 1.8; stroke-linecap: round; stroke-linejoin: round; }

    .langPill {
      display: inline-flex; background: var(--surface-2); border-radius: 100px;
      padding: 2px; gap: 0;
    }
    .langPill__btn {
      padding: 0.2rem 0.55rem; border: none; background: transparent;
      border-radius: 100px; font-size: 0.7rem; font-weight: 700;
      color: var(--ink-4); letter-spacing: 0.04em; transition: all .15s;
    }
    .langPill__btn.on { background: var(--surface-1); color: var(--ink-1); box-shadow: var(--shadow-card); }

    .hide-m { display: inline; }
    @media(max-width:680px) { .hide-m { display: none; } .tb { padding: 0.375rem; } }

    /* ═══════════════════════════════════════
       HERO
    ═══════════════════════════════════════ */
    .hero {
      max-width: 640px; margin: 0 auto;
      padding: 3.5rem 1.5rem 1.25rem; text-align: center;
    }
    .hero__h {
      font-size: 1.6rem; font-weight: 900; color: var(--ink-1);
      letter-spacing: -0.03em; line-height: 1.15; margin-bottom: 1.5rem;
    }
    .hero__h em {
      font-style: normal;
      background: linear-gradient(135deg, var(--brand) 0%, #F0845C 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Search */
    .search { position: relative; margin-bottom: 1.25rem; }
    .search__icon {
      position: absolute; left: 1rem; top: 50%; transform: translateY(-50%);
      width: 16px; height: 16px; color: var(--ink-4); pointer-events: none;
    }
    .search__input {
      width: 100%; padding: 0.75rem 2.5rem 0.75rem 2.75rem;
      background: var(--surface-1); border: 1.5px solid var(--line);
      border-radius: var(--r-lg); font-size: 0.9rem; color: var(--ink-1);
      outline: none; transition: all .2s; box-shadow: var(--shadow-card);
    }
    .search__input::placeholder { color: var(--ink-4); }
    .search__input:focus { border-color: var(--brand); box-shadow: 0 0 0 3px var(--brand-dim); }
    .search__clear {
      position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%);
      background: var(--surface-3); border: none; border-radius: 100px;
      width: 20px; height: 20px; font-size: 0.7rem; color: var(--ink-3);
      display: none; align-items: center; justify-content: center; transition: background .1s;
    }
    .search__clear:hover { background: var(--line-strong); }
    .search__clear.vis { display: flex; }

    /* Chips */
    .chips {
      display: flex; flex-wrap: wrap; gap: 0.375rem;
      justify-content: center; margin-bottom: 1.5rem;
    }
    .chip {
      padding: 0.3125rem 0.75rem;
      background: var(--surface-1); border: 1px solid var(--line);
      border-radius: 100px; font-size: 0.75rem; font-weight: 500;
      color: var(--ink-3); transition: all .15s; white-space: nowrap;
    }
    .chip:hover { border-color: var(--line-strong); color: var(--ink-2); }
    .chip.on { background: var(--ink-1); border-color: var(--ink-1); color: var(--surface-0); }
    [data-theme="dark"] .chip.on { background: var(--ink-1); color: var(--surface-0); }

    /* Stats */
    .stats {
      display: flex; justify-content: center; gap: 2.5rem;
      padding: 0.25rem 0 0.5rem;
    }
    .stats__n { font-size: 1.35rem; font-weight: 900; color: var(--brand); line-height: 1; font-variant-numeric: tabular-nums; }
    .stats__l { font-size: 0.6rem; color: var(--ink-4); text-transform: uppercase; letter-spacing: 0.08em; font-weight: 700; margin-top: 0.15rem; }

    /* ═══════════════════════════════════════
       TOOLBAR
    ═══════════════════════════════════════ */
    .toolbar-wrap { max-width: 1280px; margin: 0 auto; padding: 0 1.5rem; }
    .toolbar {
      display: flex; align-items: center; justify-content: space-between;
      gap: 0.5rem; padding: 0.625rem 0; border-top: 1px solid var(--line);
      border-bottom: 1px solid var(--line); flex-wrap: wrap;
    }
    .toolbar__l { display: flex; align-items: center; gap: 0.375rem; flex-wrap: wrap; }
    .toolbar__r { display: flex; align-items: center; gap: 0.375rem; }

    .dd { position: relative; }
    .dd__trigger {
      display: inline-flex; align-items: center; gap: 0.2rem;
      padding: 0.3125rem 0.625rem; background: var(--surface-1);
      border: 1px solid var(--line); border-radius: var(--r-sm);
      font-size: 0.75rem; font-weight: 500; color: var(--ink-3);
      cursor: pointer; list-style: none; user-select: none; transition: all .12s;
    }
    .dd__trigger::-webkit-details-marker { display: none; }
    .dd__trigger::after { content: '▾'; font-size: 0.6em; margin-left: 0.15rem; color: var(--ink-4); }
    .dd__trigger:hover { border-color: var(--line-strong); color: var(--ink-2); }
    .dd[open] > .dd__trigger { border-color: var(--brand); color: var(--brand-text); }

    .dd__panel {
      position: absolute; top: calc(100% + 3px); left: 0; z-index: 60;
      background: var(--surface-1); border: 1px solid var(--line);
      border-radius: var(--r-md); padding: 0.375rem;
      min-width: 200px; max-height: 280px; overflow-y: auto;
      box-shadow: var(--shadow-dropdown);
      animation: dd-in .12s ease;
    }
    @keyframes dd-in { from { opacity: 0; transform: translateY(-3px); } to { opacity: 1; transform: translateY(0); }}

    .dd__opt {
      display: flex; align-items: center; gap: 0.5rem;
      padding: 0.375rem 0.5rem; border-radius: var(--r-xs);
      font-size: 0.75rem; color: var(--ink-3); cursor: pointer; transition: background .08s;
    }
    .dd__opt:hover { background: var(--surface-2); }
    .dd__opt input { accent-color: var(--brand); margin: 0; width: 13px; height: 13px; }
    .dd__opt.ck { color: var(--ink-1); font-weight: 500; }

    .sel {
      padding: 0.3125rem 0.625rem; background: var(--surface-1);
      border: 1px solid var(--line); border-radius: var(--r-sm);
      font-size: 0.75rem; color: var(--ink-3); outline: none; cursor: pointer;
    }

    .lnk {
      background: none; border: none; color: var(--brand-text);
      font-size: 0.75rem; font-weight: 500; padding: 0.3125rem 0.5rem;
      border-radius: var(--r-sm); transition: background .12s;
    }
    .lnk:hover { background: var(--brand-dim); }

    /* ═══════════════════════════════════════
       GRID
    ═══════════════════════════════════════ */
    .main { max-width: 1280px; margin: 0 auto; padding: 0 1.5rem; }

    .grid-head {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.875rem 0 0.625rem;
    }
    .pill {
      display: inline-flex; padding: 0.2rem 0.55rem;
      background: var(--surface-3); border-radius: 100px;
      font-size: 0.7rem; font-weight: 600; color: var(--ink-3);
    }
    .dim { font-size: 0.75rem; color: var(--ink-4); font-variant-numeric: tabular-nums; }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 0.625rem; padding-bottom: 3rem;
    }
    @media(max-width:640px) { .grid { grid-template-columns: 1fr; } }

    /* ═══════════════════════════════════════
       CARD
    ═══════════════════════════════════════ */
    .c {
      position: relative;
      background: var(--surface-1); border: 1px solid var(--line);
      border-radius: var(--r-md); padding: 1rem 1rem 0.875rem;
      cursor: pointer; transition: all .18s ease;
      display: flex; flex-direction: column; gap: 0.5rem;
    }
    .c:hover { box-shadow: var(--shadow-hover); border-color: var(--line-strong); transform: translateY(-1px); }

    .c__row { display: flex; align-items: center; justify-content: space-between; gap: 0.5rem; }
    .c__cat {
      font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.07em;
      font-weight: 700; color: var(--brand-text); line-height: 1.2;
    }
    .c__cx {
      display: inline-flex; align-items: center; gap: 0.2rem;
      padding: 0.1rem 0.4rem; border-radius: 100px;
      font-size: 0.6rem; font-weight: 700; flex-shrink: 0;
    }
    .c__cx::before { content: ''; width: 5px; height: 5px; border-radius: 50%; }
    .c__cx--1 { background: #1A875412; color: var(--cx1); } .c__cx--1::before { background: var(--cx1); }
    .c__cx--2 { background: #2563EB12; color: var(--cx2); } .c__cx--2::before { background: var(--cx2); }
    .c__cx--3 { background: #D9770612; color: var(--cx3); } .c__cx--3::before { background: var(--cx3); }
    .c__cx--4 { background: #DC262612; color: var(--cx4); } .c__cx--4::before { background: var(--cx4); }

    .c__title {
      font-size: 0.9375rem; font-weight: 700; color: var(--ink-1);
      line-height: 1.3; letter-spacing: -0.01em;
    }
    .c__desc {
      font-size: 0.775rem; color: var(--ink-3); line-height: 1.45;
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
    }
    .c__foot {
      display: flex; align-items: center; justify-content: space-between;
      margin-top: auto; padding-top: 0.375rem;
    }
    .c__tags { display: flex; gap: 0.25rem; flex-wrap: wrap; flex: 1; }
    .c__tag {
      font-size: 0.625rem; padding: 0.1rem 0.4rem;
      background: var(--surface-3); border-radius: 100px;
      color: var(--ink-4); font-weight: 500;
    }
    .c__id {
      font-family: var(--mono); font-size: 0.6rem; color: var(--ink-4); flex-shrink: 0;
    }

    .c__star {
      position: absolute; top: 0.6rem; right: 0.6rem;
      background: none; border: none; font-size: 0.85rem; opacity: 0;
      transition: opacity .12s; padding: 0.2rem; z-index: 2;
    }
    .c:hover .c__star { opacity: .4; }
    .c__star:hover { opacity: 1 !important; }
    .c__star.on { opacity: 1; }

    mark { background: var(--brand-dim); color: var(--brand-text); border-radius: 2px; padding: 0 1px; }

    .c { animation: rise .25s ease both; }
    .c:nth-child(2) { animation-delay: .02s; }
    .c:nth-child(3) { animation-delay: .04s; }
    .c:nth-child(4) { animation-delay: .06s; }
    .c:nth-child(5) { animation-delay: .08s; }
    .c:nth-child(6) { animation-delay: .10s; }
    @keyframes rise { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); }}

    /* ═══════════════════════════════════════
       EMPTY
    ═══════════════════════════════════════ */
    .empty {
      text-align: center; padding: 4rem 1rem; color: var(--ink-4); grid-column: 1/-1;
    }
    .empty__ico { font-size: 2rem; margin-bottom: 0.75rem; opacity: .5; }
    .empty__h { font-size: 1rem; font-weight: 700; color: var(--ink-2); margin-bottom: 0.25rem; }

    /* ═══════════════════════════════════════
       DETAIL PAGE
    ═══════════════════════════════════════ */
    .page { display: block; }
    .page--off { display: none; }

    .det-top {
      max-width: 1280px; margin: 0 auto; padding: 0.875rem 1.5rem;
      display: flex; align-items: center; justify-content: space-between;
    }
    .det-layout {
      max-width: 1280px; margin: 0 auto; padding: 0 1.5rem 4rem;
      display: grid; grid-template-columns: 1fr 260px; gap: 2rem; align-items: start;
    }
    @media(max-width:880px) { .det-layout { grid-template-columns: 1fr; } }

    .det-editor { display: flex; flex-direction: column; gap: 0.875rem; }
    .det-h {
      font-size: 1.35rem; font-weight: 900; letter-spacing: -0.02em; color: var(--ink-1);
    }
    .det-meta { display: flex; align-items: center; gap: 0.625rem; flex-wrap: wrap; }
    .det-meta__i { font-size: 0.775rem; color: var(--ink-3); display: inline-flex; align-items: center; gap: 0.25rem; }

    .det-textarea {
      width: 100%; min-height: 360px; padding: 1.125rem;
      background: var(--surface-2); border: 1.5px solid var(--line);
      border-radius: var(--r-md); font-family: var(--mono);
      font-size: 0.8rem; line-height: 1.75; color: var(--ink-1);
      resize: vertical; outline: none; transition: border-color .2s;
    }
    .det-textarea:focus { border-color: var(--brand); }

    .det-actions { display: flex; gap: 0.375rem; flex-wrap: wrap; }
    .btn {
      display: inline-flex; align-items: center; gap: 0.3rem;
      padding: 0.5rem 1rem; border: 1px solid var(--line);
      border-radius: var(--r-sm); font-size: 0.8rem; font-weight: 600;
      color: var(--ink-2); background: var(--surface-1); transition: all .15s;
    }
    .btn:hover { border-color: var(--line-strong); color: var(--ink-1); }
    .btn--brand { background: var(--brand); border-color: var(--brand); color: #fff; }
    .btn--brand:hover { background: var(--brand-hover); border-color: var(--brand-hover); color: #fff; }

    /* Sidebar */
    .det-side { display: flex; flex-direction: column; gap: 1.125rem; position: sticky; top: 72px; }
    .si { display: flex; flex-direction: column; gap: 0.375rem; }
    .si__k {
      font-size: 0.6rem; text-transform: uppercase; letter-spacing: 0.08em;
      font-weight: 700; color: var(--ink-4);
    }
    .si__v { font-size: 0.8rem; color: var(--ink-2); }
    .vars { display: flex; flex-wrap: wrap; gap: 0.3rem; }
    .var {
      padding: 0.175rem 0.5rem; background: var(--brand-dim);
      border: 1px solid var(--brand-text); border-radius: var(--r-xs);
      font-family: var(--mono); font-size: 0.7rem; color: var(--brand-text); font-weight: 500;
    }
    .tags-row { display: flex; flex-wrap: wrap; gap: 0.25rem; }
    .det-tag {
      font-size: 0.7rem; padding: 0.125rem 0.45rem; background: var(--surface-3);
      border-radius: 100px; color: var(--ink-4); font-weight: 500;
    }

    /* Framework reference */
    .fw-ref {
      background: var(--surface-2); border: 1px solid var(--line);
      border-radius: var(--r-md); overflow: hidden;
    }
    .fw-ref > summary {
      padding: 0.625rem 0.75rem; font-size: 0.75rem; font-weight: 700;
      color: var(--ink-3); cursor: pointer; list-style: none; transition: background .12s;
    }
    .fw-ref > summary::-webkit-details-marker { display: none; }
    .fw-ref > summary:hover { background: var(--surface-3); }
    .fw-ref__body { padding: 0 0.75rem 0.75rem; }
    .fw-ref__body p { font-size: 0.75rem; color: var(--ink-3); line-height: 1.55; margin-bottom: 0.375rem; }
    .fw-ref__body strong { color: var(--brand-text); font-weight: 700; }

    /* ═══════════════════════════════════════
       TOAST
    ═══════════════════════════════════════ */
    .toast {
      position: fixed; bottom: 1.5rem; left: 50%;
      transform: translateX(-50%) translateY(120%);
      background: var(--ink-1); color: var(--surface-0);
      padding: 0.625rem 1.25rem; border-radius: var(--r-md);
      font-size: 0.8rem; font-weight: 600; box-shadow: var(--shadow-toast);
      z-index: 200; opacity: 0; transition: all .25s cubic-bezier(.34,1.56,.64,1);
      pointer-events: none;
    }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* Footer */
    .foot {
      text-align: center; padding: 1rem 0 2rem;
      font-size: 0.7rem; color: var(--ink-4); letter-spacing: 0.01em;
    }
    .foot code { font-family: var(--mono); font-size: 0.65rem; background: var(--surface-3); padding: 0.1rem 0.3rem; border-radius: 3px; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--line); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--ink-4); }
  </style>
</head>

<body>

  <!-- ─── TOPBAR ─── -->
  <header class="topbar">
    <div class="topbar__inner">
      <a class="brand" href="./" aria-label="Connect Prompt Library">
        <img class="brand__logo" src="./connect-logo.png" alt="Connect" />
        <span class="brand__sep"></span>
        <span class="brand__label">Prompt Library</span>
      </a>
      <div class="topbar__right">
        <div class="langPill">
          <button class="langPill__btn on" data-lang="es" type="button">ES</button>
          <button class="langPill__btn" data-lang="en" type="button">EN</button>
        </div>
        <button class="tb" id="btnFav" type="button" title="Favoritos">
          <svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.27 5.82 22 7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
          <span class="hide-m">Favoritos</span>
        </button>
        <button class="tb" id="btnTheme" type="button" title="Tema">
          <svg viewBox="0 0 24 24" id="themeIco"><path d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z"/></svg>
          <span class="hide-m" id="themeLabel">Oscuro</span>
        </button>
      </div>
    </div>
  </header>

  <!-- ─── LIST PAGE ─── -->
  <main class="page" id="pgList">
    <section class="hero">
      <h1 class="hero__h" id="heroH">¿Qué necesitas <em>hacer hoy</em>?</h1>
      <div class="search">
        <svg class="search__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input id="q" class="search__input" type="search" placeholder="Buscar: SOP, correo, proveedor, seguridad, QA…" autocomplete="off" />
        <button class="search__clear" id="btnClear" type="button">✕</button>
      </div>
      <div class="chips" id="chips"></div>
      <div class="stats">
        <div><div class="stats__n" id="sTotal">—</div><div class="stats__l">Prompts</div></div>
        <div><div class="stats__n" id="sCats">—</div><div class="stats__l">Categorías</div></div>
        <div><div class="stats__n" id="sFavs">0</div><div class="stats__l">Favoritos</div></div>
      </div>
    </section>

    <div class="toolbar-wrap">
      <div class="toolbar">
        <div class="toolbar__l">
          <details class="dd" id="ddCat"><summary class="dd__trigger">Categoría</summary><div class="dd__panel" id="fCats"></div></details>
          <details class="dd" id="ddTag"><summary class="dd__trigger">Tags</summary><div class="dd__panel" id="fTags"></div></details>
          <button class="lnk" id="btnReset" type="button">Limpiar</button>
        </div>
        <div class="toolbar__r">
          <select id="sort" class="sel">
            <option value="rel">Relevancia</option>
            <option value="az">A → Z</option>
            <option value="za">Z → A</option>
            <option value="id+">ID ↑</option>
            <option value="id-">ID ↓</option>
          </select>
        </div>
      </div>
    </div>

    <section class="main">
      <div class="grid-head">
        <div class="pill" id="badge">Todos</div>
        <div class="dim" id="count">—</div>
      </div>
      <div class="grid" id="grid"></div>
      <div class="foot">Connect Prompt Library v2.0 · Framework T-C-R-E-I · <code>prompts.json</code></div>
    </section>
  </main>

  <!-- ─── DETAIL PAGE ─── -->
  <main class="page page--off" id="pgDet">
    <div class="det-top">
      <button class="lnk" id="btnBack" type="button">← Volver</button>
      <button class="tb" id="btnDetFav" type="button">
        <svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.27 5.82 22 7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
        <span class="hide-m">Favorito</span>
      </button>
    </div>
    <section class="det-layout">
      <section class="det-editor">
        <div class="det-h" id="dH">—</div>
        <div class="det-meta" id="dMeta"></div>
        <textarea class="det-textarea" id="dText" spellcheck="false"></textarea>
        <div class="det-actions">
          <button class="btn btn--brand" id="btnCopy" type="button">Copiar prompt</button>
          <button class="btn" id="btnRestore" type="button">Restaurar</button>
        </div>
      </section>
      <aside class="det-side">
        <div class="si"><div class="si__k">ID</div><div class="si__v" id="dId" style="font-family:var(--mono)">—</div></div>
        <div class="si"><div class="si__k">Variables</div><div class="vars" id="dVars"></div></div>
        <div class="si"><div class="si__k">Tags</div><div class="tags-row" id="dTags"></div></div>
        <details class="fw-ref">
          <summary>Frameworks de prompts</summary>
          <div class="fw-ref__body">
            <p><strong>T-C-R-E-I</strong> (usado en esta librería): Tarea · Contexto · Reglas · Ejemplo · Inputs. Ideal para prompts operativos con estructura clara.</p>
            <p><strong>RISEN</strong>: Role · Instructions · Steps · End goal · Narrowing. Mejor para proyectos complejos con múltiples restricciones.</p>
            <p><strong>CRISPE</strong>: Capacity · Role · Insight · Statement · Personality · Experiment. Excelente para control creativo y tonal.</p>
            <p><strong>RTF</strong>: Role · Task · Format. El más simple, útil para tareas rápidas y directas.</p>
          </div>
        </details>
      </aside>
    </section>
  </main>

  <div class="toast" id="toast" aria-live="polite"></div>

  <!-- ═══════════════════════════════════════
       APP
  ═══════════════════════════════════════ -->
  <script>
  (function(){
    'use strict';

    const CX_MAP = {1:'Básico',2:'Estándar',3:'Intermedio',4:'Avanzado'};
    let DATA=[], LANG=localStorage.getItem('cpl_l')||'es',
        FAVS=JSON.parse(localStorage.getItem('cpl_f')||'[]'),
        chipCat=null, filters={cats:[],tags:[]}, cur=null, origText='';

    const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
    const q=$('#q'), grid=$('#grid'), badge=$('#badge'), count=$('#count'),
          pgL=$('#pgList'), pgD=$('#pgDet'), toastEl=$('#toast');

    // --- helpers ---
    function t(o){if(!o)return'';if(typeof o==='string')return o;return o[LANG]||o.es||o.en||'';}
    function ck(p){return p.category?.key||'';}
    function cl(p){return t(p.category);}
    function norm(s){return(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase();}

    // --- theme ---
    let theme=localStorage.getItem('cpl_t')||'light';
    document.documentElement.setAttribute('data-theme',theme);
    updTheme();
    $('#btnTheme').onclick=()=>{
      theme=theme==='dark'?'light':'dark';
      document.documentElement.setAttribute('data-theme',theme);
      localStorage.setItem('cpl_t',theme);updTheme();
    };
    function updTheme(){
      const d=theme==='dark';
      $('#themeIco').innerHTML=d?'<circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>':'<path d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z"/>';
      $('#themeLabel').textContent=d?(LANG==='es'?'Claro':'Light'):(LANG==='es'?'Oscuro':'Dark');
    }

    // --- lang ---
    $$('.langPill__btn').forEach(b=>b.onclick=()=>{
      LANG=b.dataset.lang;localStorage.setItem('cpl_l',LANG);
      $$('.langPill__btn').forEach(x=>x.classList.toggle('on',x.dataset.lang===LANG));
      buildUI();updTheme();
    });
    $$('.langPill__btn').forEach(b=>b.classList.toggle('on',b.dataset.lang===LANG));

    // --- load ---
    async function load(){
      grid.innerHTML='<div class="empty"><div class="empty__ico">◌</div><div class="empty__h">Cargando…</div></div>';
      try{
        const r=await fetch('./prompts.json');if(!r.ok)throw new Error(r.status);
        const d=await r.json();DATA=Array.isArray(d)?d:(d.prompts||[]);buildUI();
      }catch(e){
        grid.innerHTML='<div class="empty"><div class="empty__ico">!</div><div class="empty__h">prompts.json no encontrado</div><div style="font-size:.8rem">Verifica que el archivo exista en la raíz del repo.</div></div>';
      }
    }

    function buildUI(){
      $('#heroH').innerHTML=LANG==='es'?'¿Qué necesitas <em>hacer hoy</em>?':'What do you need to <em>do today</em>?';
      q.placeholder=LANG==='es'?'Buscar: SOP, correo, proveedor, seguridad, QA…':'Search: SOP, email, vendor, security, QA…';
      const cats=[];const seen=new Set();
      DATA.forEach(p=>{const k=ck(p);if(!seen.has(k)){seen.add(k);cats.push({k,l:cl(p)});}});
      $('#sTotal').textContent=DATA.length;$('#sCats').textContent=cats.length;updFavN();
      // chips
      const allW=LANG==='es'?'Todos':'All';
      $('#chips').innerHTML=`<button class="chip" data-ck="all">${allW}</button>`+cats.map(c=>`<button class="chip" data-ck="${c.k}">${c.l}</button>`).join('');
      $('#chips').querySelectorAll('.chip').forEach(ch=>ch.onclick=()=>{
        const v=ch.dataset.ck;$('#chips').querySelectorAll('.chip').forEach(x=>x.classList.remove('on'));
        chipCat=chipCat===v?null:v;if(chipCat)ch.classList.add('on');render();
      });
      // filters
      buildDD('fCats',cats.map(c=>c.l),'cats');
      const allT=[...new Set(DATA.flatMap(p=>p.tags||[]))].filter(x=>x!=='tcrei').sort();
      buildDD('fTags',allT,'tags');
      render();
    }
    function buildDD(id,items,key){
      const el=$('#'+id);
      el.innerHTML=items.map(i=>`<label class="dd__opt"><input type="checkbox" value="${i}" data-fk="${key}">${i}</label>`).join('');
      el.onchange=e=>{
        const v=e.target.value,k=e.target.dataset.fk;
        if(e.target.checked)filters[k].push(v);else filters[k]=filters[k].filter(x=>x!==v);
        e.target.closest('.dd__opt').classList.toggle('ck',e.target.checked);render();
      };
    }

    // --- search ---
    function score(p,raw){
      if(!raw)return 1;const qn=norm(raw),ws=qn.split(/\s+/).filter(Boolean);let s=0;
      const ti=norm(t(p.title)),ca=norm(cl(p)),cak=norm(ck(p)),
            tgs=(p.tags||[]).map(norm),tx=norm(t(p.prompt)),
            vs=(p.variables||[]).map(norm),pid=norm(p.id||'');
      ws.forEach(w=>{
        if(pid.includes(w))s+=14;if(ti.includes(w))s+=10;if(ti.startsWith(w))s+=5;
        if(cak.includes(w)||ca.includes(w))s+=6;if(tgs.some(x=>x.includes(w)))s+=8;
        if(vs.some(x=>x.includes(w)))s+=4;if(tx.includes(w))s+=2;
      });if(ti.includes(qn))s+=15;return s;
    }

    function render(){
      const raw=q.value.trim();
      let res=DATA.map(p=>({...p,_s:score(p,raw)}));
      if(raw)res=res.filter(p=>p._s>0);
      if(chipCat&&chipCat!=='all')res=res.filter(p=>ck(p)===chipCat);
      if(filters.cats.length)res=res.filter(p=>filters.cats.includes(cl(p)));
      if(filters.tags.length)res=res.filter(p=>(p.tags||[]).some(x=>filters.tags.includes(x)));
      if($('#btnFav').classList.contains('on'))res=res.filter(p=>FAVS.includes(p.id));

      const sv=$('#sort').value;
      if(sv==='rel'&&raw)res.sort((a,b)=>b._s-a._s);
      else if(sv==='az')res.sort((a,b)=>t(a.title).localeCompare(t(b.title),LANG));
      else if(sv==='za')res.sort((a,b)=>t(b.title).localeCompare(t(a.title),LANG));
      else if(sv==='id+')res.sort((a,b)=>(a.id||'').localeCompare(b.id||''));
      else if(sv==='id-')res.sort((a,b)=>(b.id||'').localeCompare(a.id||''));

      const parts=[];
      if(raw)parts.push(`"${raw}"`);
      if(chipCat&&chipCat!=='all'){const m=DATA.find(p=>ck(p)===chipCat);parts.push(m?cl(m):chipCat);}
      if(filters.cats.length)parts.push(...filters.cats);
      if($('#btnFav').classList.contains('on'))parts.push('★');
      badge.textContent=parts.length?parts.join(' · '):(LANG==='es'?'Todos':'All');
      count.textContent=`${res.length} / ${DATA.length}`;

      if(!res.length){
        grid.innerHTML=`<div class="empty"><div class="empty__ico">∅</div><div class="empty__h">${LANG==='es'?'Sin resultados':'No results'}</div></div>`;return;
      }

      grid.innerHTML=res.map(p=>{
        const cx=p.complexity||2,isFav=FAVS.includes(p.id),
              preview=t(p.prompt).replace(/\*\*/g,'').replace(/\n/g,' ').substring(0,95)+'…',
              dTags=(p.tags||[]).filter(x=>x!=='tcrei').slice(0,3);
        return `<article class="c" data-id="${p.id}" tabindex="0">
          <button class="c__star ${isFav?'on':''}" data-fav="${p.id}" onclick="event.stopPropagation()">${isFav?'★':'☆'}</button>
          <div class="c__row"><span class="c__cat">${cl(p)}</span><span class="c__cx c__cx--${cx}">${CX_MAP[cx]||'Estándar'}</span></div>
          <div class="c__title">${hl(t(p.title),raw)}</div>
          <div class="c__desc">${preview}</div>
          <div class="c__foot"><div class="c__tags">${dTags.map(x=>`<span class="c__tag">${x}</span>`).join('')}</div><span class="c__id">${p.id}</span></div>
        </article>`;
      }).join('');

      grid.querySelectorAll('.c').forEach(c=>{
        c.onclick=()=>open(c.dataset.id);
        c.onkeydown=e=>{if(e.key==='Enter')open(c.dataset.id);};
      });
      grid.querySelectorAll('[data-fav]').forEach(b=>b.onclick=()=>togFav(b.dataset.fav));
    }

    function hl(text,raw){
      if(!raw)return text;const qn=norm(raw),i=norm(text).indexOf(qn);
      if(i===-1)return text;
      return text.substring(0,i)+'<mark>'+text.substring(i,i+raw.length)+'</mark>'+text.substring(i+raw.length);
    }

    // --- detail ---
    function open(id){
      const p=DATA.find(x=>x.id===id);if(!p)return;
      cur=p;origText=t(p.prompt)||'';
      pgL.classList.add('page--off');pgD.classList.remove('page--off');
      window.scrollTo(0,0);
      $('#dH').textContent=t(p.title);$('#dId').textContent=p.id;
      const cx=p.complexity||2;
      $('#dMeta').innerHTML=`<span class="det-meta__i"><span class="c__cx c__cx--${cx}">${CX_MAP[cx]||'Estándar'}</span></span>
        <span class="det-meta__i" style="color:var(--brand-text);font-weight:700">${cl(p)}</span>`;
      $('#dText').value=origText;
      const vs=p.variables||[];
      $('#dVars').innerHTML=vs.length?vs.map(v=>`<span class="var">{{${v}}}</span>`).join(''):`<span class="dim">${LANG==='es'?'Ninguna':'None'}</span>`;
      const dt=(p.tags||[]).filter(x=>x!=='tcrei');
      $('#dTags').innerHTML=dt.map(x=>`<span class="det-tag">${x}</span>`).join('');
      updDetFav(id);saveRecent(id);
    }
    function close(){pgD.classList.add('page--off');pgL.classList.remove('page--off');cur=null;}

    // --- fav ---
    function togFav(id){
      const i=FAVS.indexOf(id);
      if(i>-1){FAVS.splice(i,1);toast(LANG==='es'?'Eliminado':'Removed');}
      else{FAVS.push(id);toast(LANG==='es'?'Guardado ★':'Saved ★');}
      localStorage.setItem('cpl_f',JSON.stringify(FAVS));updFavN();
      if(cur)updDetFav(id);render();
    }
    function updDetFav(id){
      const on=FAVS.includes(id);
      $('#btnDetFav').classList.toggle('on',on);
      $('#btnDetFav').querySelector('svg').style.fill=on?'currentColor':'none';
    }
    function updFavN(){$('#sFavs').textContent=FAVS.length;}
    function saveRecent(id){
      let r=JSON.parse(localStorage.getItem('cpl_r')||'[]');
      r=r.filter(x=>x!==id);r.unshift(id);
      localStorage.setItem('cpl_r',JSON.stringify(r.slice(0,20)));
    }
    function toast(m){toastEl.textContent=m;toastEl.classList.add('show');clearTimeout(toastEl._t);toastEl._t=setTimeout(()=>toastEl.classList.remove('show'),2000);}

    async function copy(){
      const txt=$('#dText').value;
      try{await navigator.clipboard.writeText(txt);toast(LANG==='es'?'Copiado ✓':'Copied ✓');}
      catch{const ta=document.createElement('textarea');ta.value=txt;ta.style.cssText='position:fixed;opacity:0';document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);toast('Copied ✓');}
    }

    // --- events ---
    q.oninput=()=>{$('#btnClear').classList.toggle('vis',q.value.length>0);render();};
    $('#btnClear').onclick=()=>{q.value='';$('#btnClear').classList.remove('vis');q.focus();render();};
    $('#sort').onchange=render;
    $('#btnReset').onclick=()=>{
      filters={cats:[],tags:[]};chipCat=null;q.value='';$('#btnClear').classList.remove('vis');
      $('#chips').querySelectorAll('.chip').forEach(c=>c.classList.remove('on'));
      $$('.dd__opt input').forEach(cb=>{cb.checked=false;});
      $$('.dd__opt').forEach(o=>o.classList.remove('ck'));
      $$('.dd').forEach(d=>d.removeAttribute('open'));render();
    };
    $('#btnFav').onclick=()=>{$('#btnFav').classList.toggle('on');render();};
    $('#btnBack').onclick=close;
    $('#btnCopy').onclick=copy;
    $('#btnRestore').onclick=()=>{if(cur){$('#dText').value=origText;toast(LANG==='es'?'Restaurado':'Restored');}};
    $('#btnDetFav').onclick=()=>{if(cur)togFav(cur.id);};
    document.onkeydown=e=>{if(e.key==='Escape'&&cur)close();};
    document.onclick=e=>{$$('.dd').forEach(d=>{if(!d.contains(e.target))d.removeAttribute('open');});};

    load();
  })();
  </script>
</body>
</html>
